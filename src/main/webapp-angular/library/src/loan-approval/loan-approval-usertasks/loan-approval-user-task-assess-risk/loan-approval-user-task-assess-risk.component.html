<div *ngIf="forbidden" class="error-message">
    You are not authorized to perform this action.
</div>

<div *ngIf="!forbidden" class="user-task-form">
    <h2 class="title">Loan Risk Assessment</h2>
    <p class="subtitle">Case ID: {{ userTask.businessId }}</p>

    <div class="form-field">
        <label class="label">Amount:</label>
        <span>{{ amount !== null ? amount : 'Loading...' }}</span>
    </div>

    <div class="form-field">
        <label class="label">Risk Assessment:</label>
        <div class="radio-group">
            <label class="radio-option">
                <input
                        type="radio"
                        name="riskAssessment"
                        [value]="true"
                        [(ngModel)]="riskAcceptable"
                        [disabled]="userTask.endedAt != null"
                />
                <span>Accept</span>
            </label>
            <label class="radio-option">
                <input
                        type="radio"
                        name="riskAssessment"
                        [value]="false"
                        [(ngModel)]="riskAcceptable"
                        [disabled]="userTask.endedAt != null"
                />
                <span>Deny</span>
            </label>
        </div>
    </div>

    <div *ngIf="userTask.endedAt != null" class="form-field">
        <p>This Task has already been completed by {{ completedBy }} at {{ userTask.endedAt | date:'medium' }}</p>
    </div>

    <div class="button-group">
        <button
                (click)="handleCompleteTask()"
                [disabled]="riskAcceptable === null || userTask.endedAt != null || loading"
                [class.loading]="loading"
        >
            Complete Task
        </button>
        <button
                (click)="handleSaveTask()"
                [disabled]="userTask.endedAt != null || loading"
                [class.loading]="loading"
        >
            Save Task
        </button>
    </div>
</div>
